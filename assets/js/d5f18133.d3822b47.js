(self.webpackChunkbilbilak=self.webpackChunkbilbilak||[]).push([[325],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return c},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),s=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),h=s(r),m=a,f=h["".concat(p,".").concat(m)]||h[m]||u[m]||o;return r?n.createElement(f,i(i({ref:t},c),{},{components:r})):n.createElement(f,i({ref:t},c))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=h;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=r[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},3601:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return i},metadata:function(){return l},toc:function(){return p},default:function(){return c}});var n=r(2122),a=r(9756),o=(r(7294),r(3905)),i={slug:"pipeline-op",title:"Javascript Pipeline Operator and http4ts Filters",author:"Ali Sabzevari",author_title:"http4ts Core Team",author_url:"https://github.com/alisabzevari",author_image_url:"https://avatars0.githubusercontent.com/u/826242?v=4",tags:["filters"]},l={permalink:"/blog/pipeline-op",editUrl:"https://github.com/http4ts/http4ts/edit/master/website/blog/2020-03-07-pipeline-op.md",source:"@site/blog/2020-03-07-pipeline-op.md",title:"Javascript Pipeline Operator and http4ts Filters",description:"One of the unique features of http4s is its composability. You can componse multiple filters together and build reusable pieces of funtionality.",date:"2020-03-07T00:00:00.000Z",formattedDate:"March 7, 2020",tags:[{label:"filters",permalink:"/blog/tags/filters"}],readingTime:1.37,truncated:!1},p=[{value:"Enter pipeline operator",id:"enter-pipeline-operator",children:[]}],s={toc:p};function c(e){var t=e.components,r=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,n.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"One of the unique features of http4s is its composability. You can componse multiple filters together and build reusable pieces of funtionality."),(0,o.kt)("p",null,"However, composing functions in Javascript is not the best experience you can expect. As an example, consider the following filters (Implementations are removed for brevity):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"const authorize: (handler: HttpHandler) => HttpHandler; // = ...\n\nconst handleErrors: (handler: HttpHandler) => HttpHandler; // = ...\n\nconst metrics: (metricsRegistry) => (handler: HttpHandler) => HttpHandler; // = ...\n\nconst trace: (tracer) => (handler: HttpHandler) => HttpHandler; // = ...\n")),(0,o.kt)("p",null,"Composing these filters together results in something like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"const finalHandler = req =>\n  handleErrors(trace(tracer)(metrics(metricsRegistry)(authorize(req))));\n")),(0,o.kt)("p",null,"Everyone agrees that this piece of code looks weird and very hard to understand. Functional programming libraries like ",(0,o.kt)("a",{parentName:"p",href:"https://ramdajs.com/"},"Ramda")," provide helpers that improves the readability of this pattern. For example, you can use ",(0,o.kt)("a",{parentName:"p",href:"https://ramdajs.com/docs/#pipe"},(0,o.kt)("inlineCode",{parentName:"a"},"pipe")),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"const finalHandler = R.pipe(\n  authorize,\n  metrics(metricsRegistry),\n  trace(tracer),\n  handleErrors\n);\n")),(0,o.kt)("p",null,"It looks much better but still it would be great if Javascript could support this pattern in the language out of the box."),(0,o.kt)("h2",{id:"enter-pipeline-operator"},"Enter pipeline operator"),(0,o.kt)("p",null,"There is an ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tc39/proposal-pipeline-operator"},"Ecmascript proposal")," to add an operator that solves this problem. It is called pipeline operator and here is how our code will look like when Javascript supports this operator:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"const finalHandler = authorize |> metrics(metricsRegistry) |> trace(tracer) |> handleErrors \n")),(0,o.kt)("p",null,"I like this operator a lot since it visually describes the flow of the data through the functions which matches with the purpose and mechanics of http4ts filters."),(0,o.kt)("p",null,"If you also like pipeline operator, go ahead and start the proposal repository and contribute to the importance of this language feature."),(0,o.kt)("p",null,"Happy Javascripting!"))}c.isMDXComponent=!0}}]);